<ng-container *ngIf="thing$ | async as thing">
  <h1>「{{ thing.title }}」を編集</h1>
  <mat-card>
    <form [formGroup]="form" class="details" (ngSubmit)="save(thing)">
      <mat-form-field appearance="outline">
        <mat-label>タイトル</mat-label>
        <input matInput #input formControlName="title" />
        <mat-hint align="end">{{ input.value.length }}/100</mat-hint>
        <mat-error *ngIf="titleControl.hasError('maxlength')"
          >長過ぎます</mat-error
        >
        <mat-error *ngIf="titleControl.hasError('required')"
          >必須入力です</mat-error
        >
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>説明</mat-label>
        <textarea
          matInput
          formControlName="description"
          #textarea
          matTextareaAutosize
          [value]="thing.description"
        >
        </textarea>
        <mat-hint align="end">{{ textarea.value.length }}/5000</mat-hint>
        <mat-error *ngIf="descriptionControl.hasError('maxlength')"
          >長過ぎます</mat-error
        >
      </mat-form-field>
      <mat-form-field>
        <mat-label>タグ</mat-label>
        <mat-chip-list #chipList aria-label="tag selection">
          <mat-chip
            *ngFor="let tag of tags"
            [selectable]="selectable"
            [removable]="removable"
            (removed)="remove(tag)"
          >
            {{ tag }}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
          <input
            placeholder="New tag..."
            [matChipInputFor]="chipList"
            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            [matChipInputAddOnBlur]="addOnBlur"
            (matChipInputTokenEnd)="add($event)"
            formControlName="tags"
          />
        </mat-chip-list>
      </mat-form-field>
      <div class="actions">
        <button (click)="cancel(thing)" mat-button>キャンセル</button>
        <button mat-flat-button color="primary">保存</button>
      </div>
    </form>
  </mat-card>
</ng-container>
